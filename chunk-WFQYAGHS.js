import{a as C}from"./chunk-5BFDLYSU.js";import{F as B,H as L,I as G,J as F}from"./chunk-ELI6RZET.js";import"./chunk-P56RC3A5.js";import{a as k}from"./chunk-VTDYV3G2.js";import"./chunk-OBQ5ZBLJ.js";import"./chunk-23NTSYVS.js";import"./chunk-NKXSX425.js";import"./chunk-GQC6GBTQ.js";import{a as E}from"./chunk-QJ4XV6RO.js";import{hb as x,k as l,m as O,n as M,r as I,s as N,u as P,v as V,x as _}from"./chunk-FEYVFRDP.js";import{o as w}from"./chunk-RR4QGK55.js";import{Bb as $,Ca as f,Cb as j,Db as r,Eb as a,Fb as s,Jb as v,Ma as y,Mb as p,Na as S,Nb as g,Ua as T,Uc as K,Wb as o,Xc as Q,bc as R,db as u,fc as h,lc as H,mc as J,tb as b,va as c,vb as d,yb as D}from"./chunk-2XEAWUUP.js";import{a as A}from"./chunk-T527G4PA.js";var q=class i{carriagesData;formClosed=new T;formBuilder=c(V);store=c(w);initialFormValues;editCarriagesForm=this.formBuilder.group({name:["",l.required],rows:["",l.required],leftSeats:["",l.required],rightSeats:["",l.required]});ngOnInit(){this.carriagesData&&(this.editCarriagesForm.patchValue(this.carriagesData),this.initialFormValues=A({},this.carriagesData),this.editCarriagesForm.valueChanges.subscribe(t=>{this.carriagesData?.code&&this.store.dispatch(C.updCarriageType({code:this.carriagesData.code,updatedCarriage:t}))}))}updStation(){if(this.editCarriagesForm.invalid){alert("Please fill in all fields before updating.");return}let t={code:this.editCarriagesForm.get("name")?.value,name:this.editCarriagesForm.get("name")?.value,rows:this.editCarriagesForm.get("rows")?.value,leftSeats:this.editCarriagesForm.get("leftSeats")?.value,rightSeats:this.editCarriagesForm.get("rightSeats")?.value};this.carriagesData.code&&(this.store.dispatch(C.updCarriageTypeSuccsess({code:this.carriagesData.code,updatedCarriage:t})),this.formClosed.emit())}resetForm(){this.initialFormValues&&this.editCarriagesForm.patchValue(this.initialFormValues)}closeForm(){this.resetForm(),this.formClosed.emit()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=f({type:i,selectors:[["app-carriages-dynamic-form"]],inputs:{carriagesData:"carriagesData"},outputs:{formClosed:"formClosed"},standalone:!0,features:[h],decls:17,vars:1,consts:[[1,"carriages__upd-form",3,"ngSubmit","formGroup"],["placeholder","enter new name","formControlName","name"],["tuiTextfieldLegacy","","placeholder","enter new name","type","text"],["formControlName","rows"],["tuiTextfieldLegacy","","placeholder","enter new rows","type","number"],["formControlName","leftSeats"],["tuiTextfieldLegacy","","placeholder","enter new left seats","type","number"],["formControlName","rightSeats"],["tuiTextfieldLegacy","","placeholder","enter new right seats","type","number"],["size","s","tuiButton",""],["size","s","tuiButton","",3,"click"]],template:function(e,n){e&1&&(r(0,"form",0),p("ngSubmit",function(){return n.updStation()}),r(1,"tui-input",1),o(2," name "),s(3,"input",2),a(),r(4,"tui-input",3),o(5," rows "),s(6,"input",4),a(),r(7,"tui-input",5),o(8," left seats "),s(9,"input",6),a(),r(10,"tui-input",7),o(11," right seats "),s(12,"input",8),a(),r(13,"button",9),o(14,"Update carriage"),a()(),r(15,"button",10),p("click",function(){return n.closeForm()}),o(16,"Close update form"),a()),e&2&&d("formGroup",n.editCarriagesForm)},dependencies:[x,_,I,O,M,N,P,F,L,G,B],styles:["[_ngcontent-%COMP%]:root{--auth-font-weight: 600;--auth-container-width: 300px;--auth-container-padding: 20px;--auth-form-flex-gap: 20px;--auth-input-padding: 10px 5px}.carriages__upd-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px;justify-content:center;width:30vw}button[_ngcontent-%COMP%]{width:200px;margin-top:5px}@media (min-width: 425px) and (max-width: 767px){.carriages__upd-form[_ngcontent-%COMP%]{width:100%}}@media (min-width: 320px) and (max-width: 424px){.carriages__upd-form[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{width:100%}}"]})};var U=class i{formClosed=new T;formBuilder=c(V);store=c(w);createCarriagesForm=this.formBuilder.group({name:["",l.required],rows:["",l.required],leftSeats:["",l.required],rightSeats:["",l.required]});carriagesList=[];get carriagesData(){return{code:this.createCarriagesForm.get("name")?.value,name:this.createCarriagesForm.get("name")?.value,rows:this.createCarriagesForm.get("rows")?.value,leftSeats:this.createCarriagesForm.get("leftSeats")?.value,rightSeats:this.createCarriagesForm.get("rightSeats")?.value}}ngOnInit(){this.store.select(E).subscribe(t=>{this.carriagesList=t})}createStation(){if(this.createCarriagesForm.invalid){alert("Please fill in all fields before updating.");return}let t=this.carriagesData;if(this.carriagesList.some(n=>n.name===t.name)){alert("Carriage with this name already exists.");return}this.store.dispatch(C.createNewCarriageType({newCarriages:t})),this.closeForm()}closeForm(){this.formClosed.emit()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=f({type:i,selectors:[["app-carriages-dynamic-from-create"]],outputs:{formClosed:"formClosed"},standalone:!0,features:[h],decls:17,vars:2,consts:[[3,"carriagesData"],[1,"carriages__edit-form",3,"ngSubmit","formGroup"],["placeholder","enter new name","formControlName","name"],["tuiTextfieldLegacy","","placeholder","enter new name","type","text"],["formControlName","rows"],["tuiTextfieldLegacy","","placeholder","enter new rows","type","number"],["formControlName","leftSeats"],["tuiTextfieldLegacy","","placeholder","enter new left seats","type","number"],["formControlName","rightSeats"],["tuiTextfieldLegacy","","placeholder","enter new right seats","type","number"],["size","s","tuiButton",""]],template:function(e,n){e&1&&(r(0,"div"),s(1,"app-carriage",0),r(2,"form",1),p("ngSubmit",function(){return n.createStation()}),r(3,"tui-input",2),o(4," name "),s(5,"input",3),a(),r(6,"tui-input",4),o(7," rows "),s(8,"input",5),a(),r(9,"tui-input",6),o(10," left seats "),s(11,"input",7),a(),r(12,"tui-input",8),o(13," right seats "),s(14,"input",9),a(),r(15,"button",10),o(16,"Create carriage"),a()()()),e&2&&(u(),d("carriagesData",n.carriagesData),u(),d("formGroup",n.createCarriagesForm))},dependencies:[x,_,I,O,M,N,P,F,L,G,B,k],styles:["[_ngcontent-%COMP%]:root{--auth-font-weight: 600;--auth-container-width: 300px;--auth-container-padding: 20px;--auth-form-flex-gap: 20px;--auth-input-padding: 10px 5px}.carriages__edit-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px;justify-content:center;width:30vw}button[_ngcontent-%COMP%]{width:200px}@media (min-width: 425px) and (max-width: 767px){.carriages__edit-form[_ngcontent-%COMP%]{width:100%}}@media (min-width: 320px) and (max-width: 424px){.carriages__edit-form[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{width:100%}}"]})};var ie=(i,t)=>t.code;function re(i,t){if(i&1){let e=v();r(0,"h2"),o(1,"New carriage"),a(),r(2,"app-carriages-dynamic-from-create",1),p("formClosed",function(){y(e);let m=g();return S(m.closeCreateField())}),a()}}function ae(i,t){i&1&&o(0," Close create carriage ")}function ne(i,t){i&1&&o(0," Create carriage ")}function oe(i,t){if(i&1){let e=v();r(0,"app-carriages-dynamic-form",4),p("formClosed",function(){y(e);let m=g(2);return S(m.clearCurrentCarriage())}),a()}if(i&2){let e=g().$implicit;d("carriagesData",e)}}function se(i,t){if(i&1){let e=v();r(0,"button",5),p("click",function(){y(e);let m=g().$implicit,z=g();return S(z.toggleUpdForm(m))}),o(1,"Update carriage"),a()}}function me(i,t){if(i&1&&(s(0,"app-carriage",2),b(1,oe,1,1,"app-carriages-dynamic-form",2)(2,se,2,0,"button",3)),i&2){let e=t.$implicit,n=g();d("carriagesData",e),u(),D(n.currentCarriageToUpdate===e.code?1:2)}}var Y=class i{store=c(w);carriagesList$=this.store.select(E);isCreateFieldOpen=!1;currentCarriageToUpdate;constructor(){this.store.dispatch(C.loadCarriagesList())}toggleCreateField(){this.isCreateFieldOpen=!this.isCreateFieldOpen}toggleUpdForm(t){this.currentCarriageToUpdate=t.code}clearCurrentCarriage(){this.currentCarriageToUpdate=void 0}closeCreateField(){this.isCreateFieldOpen=!1}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=f({type:i,selectors:[["app-carriages"]],standalone:!0,features:[h],decls:10,vars:4,consts:[["size","l","tuiButton","",3,"click"],[3,"formClosed"],[3,"carriagesData"],["size","s","tuiButton",""],[3,"formClosed","carriagesData"],["size","s","tuiButton","",3,"click"]],template:function(e,n){if(e&1){let m=v();b(0,re,3,0),r(1,"button",0),p("click",function(){return y(m),S(n.toggleCreateField())}),b(2,ae,1,0)(3,ne,1,0),a(),r(4,"h2"),o(5,"Carriages"),a(),R(6),H(7,"async"),$(8,me,3,2,null,null,ie)}if(e&2){D(n.isCreateFieldOpen?0:-1),u(2),D(n.isCreateFieldOpen?2:3);let m=J(7,2,n.carriagesList$);u(6),j(m)}},dependencies:[x,Q,K,_,F,q,U,k],styles:["[_ngcontent-%COMP%]:root{--auth-font-weight: 600;--auth-container-width: 300px;--auth-container-padding: 20px;--auth-form-flex-gap: 20px;--auth-input-padding: 10px 5px}[_nghost-%COMP%]{display:flex;flex-direction:column;gap:10px;max-width:calc(100vw - 40px)}button[_ngcontent-%COMP%]{width:200px;margin-top:5px}@media (min-width: 425px) and (max-width: 767px){[_nghost-%COMP%]{max-width:calc(100vw - 20px)}}@media (min-width: 320px) and (max-width: 424px){[_nghost-%COMP%]{max-width:calc(100vw - 20px)}button[_ngcontent-%COMP%]{width:100%;margin-top:5px}}"]})};export{Y as CarriagesComponent};
