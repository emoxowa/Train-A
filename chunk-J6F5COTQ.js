import{a as v}from"./chunk-U3QCFURK.js";import{a as d,d as U,e as m}from"./chunk-GYE77XHX.js";import{o as i}from"./chunk-RR4QGK55.js";import{a as f,d as u}from"./chunk-EH7XB44O.js";import{$c as h,F as p,ha as a,ka as c,pa as g,t as s,ua as l,va as o}from"./chunk-2XEAWUUP.js";var n=class r{constructor(t,e){this.http=t;this.store=e}signInUrl="/api/signin";signUpUrl="/api/signup";logoutUrl="/api/logout";signIn(t,e){return this.http.post(this.signInUrl,{email:t,password:e}).pipe(c(S=>{this.setToken(S.token),this.store.dispatch(v.loadUser())}))}signUp(t,e){return this.http.post(this.signUpUrl,{email:t,password:e})}logout(){return this.http.delete(this.logoutUrl).pipe(c(()=>{this.clearToken()}))}setToken(t){localStorage.setItem("token",t)}getToken(){return localStorage.getItem("token")}clearToken(){localStorage.removeItem("token")}isAuthenticated(){return!!this.getToken()}static \u0275fac=function(e){return new(e||r)(l(h),l(i))};static \u0275prov=g({token:r,factory:r.\u0275fac,providedIn:"root"})};var L=()=>{let r=o(n),t=o(u);return r.isAuthenticated()?t.createUrlTree(["/"]):!0},M=()=>{let r=o(u),t=o(i);return t.select(m).pipe(p(e=>!e),a(()=>t.select(U).pipe(s(e=>e==="manager"?!0:r.createUrlTree(["not-found"])))))},q=r=>{let t=o(i);return t.select(m).pipe(p(e=>!e),a(()=>t.select(d).pipe(s(e=>!!e||f(r,["/signin"])))))};export{n as a,L as b,M as c,q as d};
